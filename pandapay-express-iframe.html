<!DOCTYPE html>
<html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<link href="https://s3.amazonaws.com/express.pandapay.io/patagonia-dev/pp-express.css" rel="stylesheet" type="text/css">
<link href="https://s3.amazonaws.com/express.pandapay.io/patagonia-dev/normalize.css" rel="stylesheet" type="text/css">
<div class="ppContainer">
  <div class="ppHeader">
    <span id="granteeName" class="granteeName" style="font-size:20px; line-height:28px;">[Grantee Name]</span>
  </div>
  <span class="close" style="position: absolute; top: 5vw; right: 5vw;">
    <!-- <img src="https://s3.amazonaws.com/express.pandapay.io/patagonia-dev/x-close.svg" class="close" height="16px" width="16px"> -->
    <object type="image/svg+xml" data="https://s3.amazonaws.com/express.pandapay.io/patagonia-dev/x-close.svg"></object>
  </span>
  <hr>
  <div>
    <div class="donationInfo" style="padding-right: 20px; padding-left: 20px;">
      <p>Thank you for supporting local environmental orgnanizations with your donation</p>
    </div>
    <div class="ppDonationInputArea">
      <input type="text" name="donationAmount" maxlength="8" size="8" class="donationInput" id="donationAmount" value="$" onfocus="this.value = this.value;">
      <br>
      <span class="usdText">USD</span>
      <p class="mutedDemi" style="font-size: 12px; letter-spacing: 0.24px; Padding-top: 16px;">Select your donation amount</p>
      <span id="errorText" class="ppRegFont" style="text-align: center; color: red;"></span>
      <div class="row">
        <div class="col" style="width:25%;">
          <button class="donationAmountBtn" onclick="updateDonation(5.00)">$5</button>
        </div>
        <div class="col" style="width:25%;">
          <button class="donationAmountBtn" onclick="updateDonation(25.00)">$25</button>
        </div>
        <div class="col" style="width:25%;">
          <button class="donationAmountBtn" onclick="updateDonation(50.00)">$50</button>
        </div>
        <div class="col" style="width:25%;">
          <button class="donationAmountBtn" onclick="updateDonation(100.00)">$100</button>
        </div>
      </div>
    </div>
  </div>
  <div class="ppModalContent ppRegFont ppModalFooter">
    <input id="coverFee" type="checkbox" />
    <label for="coverFee"></label>
    <span class="checkboxLabel">I agree to pay the processing fees</span>
    <div class="tooltip">
      <img src="https://s3.amazonaws.com/express.pandapay.io/patagonia-dev/tooltip.png" height="14px" width="14px">
      <span class="tooltiptext">
        Your donation is securely processed by our partner, PandaPay. They charge a transaction fee of 3.9% + 30&cent; to cover card
        fees, bank fees, and other processing costs. If you choose not to cover the transaction fee, 3.9% + 30&cent; will
        be deducted from your donation. </span>
    </div>
    <a href="#" id="nextLink" onclick="proceedToPayment()" class="proceedToPayment">Next</a>
  </div>
</div>

<script src="https://s3.amazonaws.com/express.pandapay.io/patagonia-dev/pp-express.js"></script>

<script type="text/javascript">
  donation = 0.00
  function updateDonation(donationNoFee) {
    donation = donationNoFee
    document.getElementById("donationAmount").value = '$' + parseFloat(donation).toFixed(2);
    document.getElementById("nextLink").className = "proceedToPaymentActive";
  }

  function proceedToPayment() {
    donation = document.getElementById("donationAmount").value
    donation = donation.replace("$", "");
    if (isNaN(donation)) {
      document.getElementById("errorText").innerHTML = 'Please enter a valid donation amount.';
    } else {
      if (donation.length == 0) {
      } else {
        if (document.getElementById("coverFee").checked == false) {
          localStorage.setItem('pandapayDonorCoverFees', "false");
        } else {
          localStorage.setItem('pandapayDonorCoverFees', "true");
        }
        localStorage.setItem('pandapayDonationAmount', donation);
        window.location = "https://s3.amazonaws.com/express.pandapay.io/patagonia-dev/pandapay-express-iframe-payment.html?charityName=" + getAllUrlParams().charityName + "&charityEIN=" + getAllUrlParams().charityEIN + '&patagoniaUserID=' + getAllUrlParams().patagoniaUserID + '&cyberGrantsID=' + getAllUrlParams().cyberGrantsID + '&issues=' + getAllUrlParams().issues + '&wordpressID=' + getAllUrlParams().wordpressID;;
      }
    }
  };

  $("input[name=donationAmount]").keyup(function () {
    if ($(this).val().length > 1) {
      document.getElementById("nextLink").className = "proceedToPaymentActive";
    }
    else {
      document.getElementById("nextLink").className = "proceedToPayment";
    }
  });

  $("input[name=donationAmount]").keydown(function (e) {
    var oldvalue = $(this).val();
    var field = this;
    setTimeout(function () {
      if (field.value.indexOf('$') !== 0) {
        $(field).val(oldvalue);
      }
    }, 1);
  });
</script>

</html>